uuid: aef192db-b5ad-4b89-a7ec-324234ff0c2d
langcode: en
status: true
dependencies:
  config:
    - field.field.node.certificate.field_employee
    - field.field.node.certificate.field_limit_
    - field.field.user.user.field_bonus_days
    - field.storage.node.field_employee
    - field.storage.node.field_limit_
    - field.storage.user.field_bonus_days
    - node.type.certificate
  module:
    - eca_base
    - eca_content
    - eca_tamper
id: process_s1wtrgs
modeller: bpmn_io
label: 'Bonus certificate 2.0'
version: ''
weight: null
events:
  Event_01kf1e0:
    plugin: 'content_entity:insert'
    label: 'INSERT BONUS'
    configuration:
      type: 'node certificate'
    successors:
      -
        id: Activity_1jq6trv
        condition: ''
  Event_138zc0w:
    plugin: 'content_entity:custom'
    label: Event_138zc0w
    configuration:
      event_id: x5
    successors:
      -
        id: Activity_1t1bdc4
        condition: ''
conditions:
  Flow_02f5f0r:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[new_bonus_certificate:field_type_certificate:value]'
      right: '2'
      operator: equal
      type: value
gateways: {  }
actions:
  Activity_1jq6trv:
    plugin: eca_token_load_entity
    label: 'LOAD CERTIFICATE'
    configuration:
      token_name: new_bonus_certificate
      from: current
      entity_type: _none
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: ''
    successors:
      -
        id: Activity_08kc3a3
        condition: Flow_02f5f0r
  Activity_08kc3a3:
    plugin: eca_token_load_entity_ref
    label: Activity_08kc3a3
    configuration:
      field_name_entity_ref: field_employee
      token_name: employee
      from: current
      entity_type: user
      entity_id: ''
      revision_id: ''
      properties: ''
      langcode: _interface
      latest_revision: false
      unchanged: false
      object: ''
    successors:
      -
        id: Activity_0ok4avq
        condition: ''
      -
        id: Activity_0hx14st
        condition: ''
  Activity_0ok4avq:
    plugin: action_message_action
    label: Activity_0ok4avq
    configuration:
      replace_tokens: false
      message: 'завантажили юзера з ноди бонусного сертифіката [employee]'
    successors: {  }
  Activity_1t1bdc4:
    plugin: 'eca_tamper:math'
    label: Activity_1t1bdc4
    configuration:
      operation: addition
      flip: false
      value: '[new_bonus_certificate:field_limit_:value]'
      eca_data: '[employee:field_bonus_days:value]'
      eca_token_name: number_bonus_day
    successors:
      -
        id: Activity_1kqv79i
        condition: ''
      -
        id: Activity_09u20n7
        condition: ''
  Activity_1kqv79i:
    plugin: eca_set_field_value
    label: 'set field Bonus day'
    configuration:
      field_name: field_bonus_days
      field_value: '[number_bonus_day]'
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: '[employee]'
    successors:
      -
        id: Activity_02dma82
        condition: ''
  Activity_09u20n7:
    plugin: action_message_action
    label: Activity_09u20n7
    configuration:
      replace_tokens: false
      message: |-
        [number_bonus_day]-> кількість бонуснів
        [new_bonus_certificate:field_limit_:value] -> бонусні з сертифіката
    successors: {  }
  Activity_02dma82:
    plugin: action_message_action
    label: Activity_02dma82
    configuration:
      replace_tokens: false
      message: 'заповнили філд [employee:field_bonus_days:value]'
    successors: {  }
  Activity_0hx14st:
    plugin: eca_trigger_content_entity_custom_event
    label: TRIGGER
    configuration:
      event_id: x5
      tokens: ''
      object: '[new_bonus_certificate]'
    successors: {  }
