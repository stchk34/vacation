uuid: 64ccdba3-be2c-43dc-a8df-fa4115dbcbab
langcode: en
status: true
dependencies:
  config:
    - views.view.list_all_current_certificate
  module:
    - eca_base
    - eca_content
    - eca_user
    - eca_views
    - node
id: process_en2yizt
modeller: bpmn_io
label: 'Unpublish certificate'
version: ''
weight: null
events:
  Event_0ofofq8:
    plugin: 'eca_base:eca_cron'
    label: CRON
    configuration:
      frequency: '* * * * *'
    successors:
      -
        id: Activity_04z6m9c
        condition: ''
conditions:
  Flow_1ykobyv:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: publish_certificate
      right: '0'
      operator: greaterthan
      type: value
  Flow_0i578j5:
    plugin: eca_scalar
    configuration:
      negate: false
      case: false
      left: '[current-date:raw]'
      right: '[first_certificate:field_use_up:date:raw]'
      operator: greaterthan
      type: value
gateways:
  Gateway_1duowq6:
    type: 0
    successors:
      -
        id: Activity_10erjzz
        condition: Flow_1ykobyv
actions:
  Activity_04z6m9c:
    plugin: eca_switch_account
    label: 'switch to admin'
    configuration:
      user_id: '1'
    successors:
      -
        id: Activity_0781ov4
        condition: ''
  Activity_0781ov4:
    plugin: eca_views_query
    label: 'view All certificate'
    configuration:
      token_name: publish_certificate
      view_id: list_all_current_certificate
      display_id: page_1
      arguments: ''
    successors:
      -
        id: Gateway_1duowq6
        condition: ''
  Activity_10erjzz:
    plugin: eca_list_remove
    label: 'drop first node'
    configuration:
      value: ''
      token_name: first_certificate
      method: first
      index: ''
      list_token: publish_certificate
    successors:
      -
        id: Activity_0yio96k
        condition: Flow_0i578j5
  Activity_0uyed2y:
    plugin: 'entity:unpublish_action:node'
    label: 'unpublish certificate'
    configuration:
      object: '[first_certificate]'
    successors:
      -
        id: Gateway_1duowq6
        condition: ''
  Activity_0yio96k:
    plugin: eca_set_field_value
    label: 'set state Disabled'
    configuration:
      field_name: field_current_state_certificate
      field_value: state_certificate_disabled
      method: 'set:clear'
      strip_tags: false
      trim: false
      save_entity: false
      object: '[first_certificate]'
    successors:
      -
        id: Activity_0uyed2y
        condition: ''
